{
  "hash": "1ecd29cc27eda6f5f6fa375ffdaac0e3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Penguin\"\nexecute:\n  warning: false\n---\n\n\nThis analysis takes the best from three analysis on the Penguin data.\n\nShowing mostly a PCA, and Simpson's paradox.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(palmerpenguins)\nlibrary(dplyr)\nlibrary(tidyr)\ndata(\"penguins\")\nstr(penguins)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [344 × 8] (S3: tbl_df/tbl/data.frame)\n $ species          : Factor w/ 3 levels \"Adelie\",\"Chinstrap\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ island           : Factor w/ 3 levels \"Biscoe\",\"Dream\",..: 3 3 3 3 3 3 3 3 3 3 ...\n $ bill_length_mm   : num [1:344] 39.1 39.5 40.3 NA 36.7 39.3 38.9 39.2 34.1 42 ...\n $ bill_depth_mm    : num [1:344] 18.7 17.4 18 NA 19.3 20.6 17.8 19.6 18.1 20.2 ...\n $ flipper_length_mm: int [1:344] 181 186 195 NA 193 190 181 195 193 190 ...\n $ body_mass_g      : int [1:344] 3750 3800 3250 NA 3450 3650 3625 4675 3475 4250 ...\n $ sex              : Factor w/ 2 levels \"female\",\"male\": 2 1 1 NA 1 2 1 2 NA NA ...\n $ year             : int [1:344] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...\n```\n\n\n:::\n:::\n\n\nhttps://allisonhorst.github.io/palmerpenguins/\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins %>% \n  group_by(species) %>% \n  summarize(across(where(is.numeric), mean, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 6\n  species   bill_length_mm bill_depth_mm flipper_length_mm body_mass_g  year\n  <fct>              <dbl>         <dbl>             <dbl>       <dbl> <dbl>\n1 Adelie              38.8          18.3              190.       3701. 2008.\n2 Chinstrap           48.8          18.4              196.       3733. 2008.\n3 Gentoo              47.5          15.0              217.       5076. 2008.\n```\n\n\n:::\n:::\n\n\nFor this example:\n\n-   shorten variable names (remove units) to simplify variable labels,\n\n-   create factors for character variables (needed for MANOVA), and\n\n-   remove NA observations (causes problems with PCA)\n\n\n::: {.cell}\n\n```{.r .cell-code}\npeng <- penguins %>%\n    dplyr::rename(\n         bill_length = bill_length_mm, \n         bill_depth = bill_depth_mm, \n         flipper_length = flipper_length_mm, \n         body_mass = body_mass_g)\npeng <- peng %>% drop_na()\npeng\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 333 × 8\n   species island    bill_length bill_depth flipper_length body_mass sex    year\n   <fct>   <fct>           <dbl>      <dbl>          <int>     <int> <fct> <int>\n 1 Adelie  Torgersen        39.1       18.7            181      3750 male   2007\n 2 Adelie  Torgersen        39.5       17.4            186      3800 fema…  2007\n 3 Adelie  Torgersen        40.3       18              195      3250 fema…  2007\n 4 Adelie  Torgersen        36.7       19.3            193      3450 fema…  2007\n 5 Adelie  Torgersen        39.3       20.6            190      3650 male   2007\n 6 Adelie  Torgersen        38.9       17.8            181      3625 fema…  2007\n 7 Adelie  Torgersen        39.2       19.6            195      4675 male   2007\n 8 Adelie  Torgersen        41.1       17.6            182      3200 fema…  2007\n 9 Adelie  Torgersen        38.6       21.2            191      3800 male   2007\n10 Adelie  Torgersen        34.6       21.1            198      4400 male   2007\n# ℹ 323 more rows\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\nlibrary(ggbiplot)\nlibrary(GGally)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nscatterplotMatrix(~ bill_length + bill_depth + flipper_length + body_mass | species,\n                  data=peng,\n                  ellipse=list(levels=0.68),\n                  col = scales::hue_pal()(3),\n                  legend=list(coords=\"bottomright\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggpairs(peng, mapping = aes(color = species), \n        columns = c(\"bill_length\", \"bill_depth\", \n                    \"flipper_length\", \"body_mass\",\n                    \"island\", \"sex\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npeng.pca <- prcomp (~ bill_length + bill_depth + flipper_length + body_mass,\n                    data=peng,\n                    scale. = TRUE)\n\npeng.pca\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStandard deviations (1, .., p=4):\n[1] 1.6569115 0.8821095 0.6071594 0.3284579\n\nRotation (n x k) = (4 x 4):\n                      PC1         PC2        PC3        PC4\nbill_length     0.4537532 -0.60019490 -0.6424951  0.1451695\nbill_depth     -0.3990472 -0.79616951  0.4258004 -0.1599044\nflipper_length  0.5768250 -0.00578817  0.2360952 -0.7819837\nbody_mass       0.5496747 -0.07646366  0.5917374  0.5846861\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nscreeplot(peng.pca, type = \"line\", lwd=3, cex=3, \n        main=\"Variances of PCA Components\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggbiplot(peng.pca, obs.scale = 1, var.scale = 1,\n         groups = peng$species, \n         ellipse = TRUE, circle = TRUE) +\n  scale_color_discrete(name = 'Penguin Species') +\n  theme_minimal() +\n  theme(legend.direction = 'horizontal', legend.position = 'top') \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nFrom this, we can see:\n\n-   These two principal components account for 68.6 + 19.5 = 88.1 % of the total variance of these four size variables.\n\n-   PC1 is largely determined by flipper length and body mass. We can interpret this as an overall measure of **penguin size**.\n\n-   On this dimension, Gentoos are the largest, by quite a lot, compared with Adelie and Chinstrap.\n\n-   PC2 is mainly determined by variation in the two beak variables: bill length and depth. Chinstrap are lower than the other two species on bill length and depth, but bill length further distinguishes the Gentoos. A penguin biologist could almost certainly provide an explanation, but I'll call this **beak shape**.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}